# Picals 项目设计文档

> **版本**：v1.0  
> **性质**：开源兴趣项目  
> **定位**：插画收藏与索引平台，偏向收藏者而非创作者  
> **目标人群**：二次元爱好者、插画收藏者、小圈子朋友  
> **项目状态**：立项指南与行动方针

---

## 1. 项目愿景

Picals 致力于打造一个 **以收藏者为中心** 的插画索引与收藏平台。  
核心不是再造 Pixiv，而是解决「找不到图」的问题，让用户能通过 **标签检索** 与 **合集策展** 快速定位和整理插画。

关键氛围：

- **收藏感**：像整理个人书架、歌单，而非无序的图床。
- **低成本可持续**：开源、Serverless 优先，免费层先行。
- **轻社交**：点赞、评论、关注合集，强调“围绕作品的讨论”，而非人际关系绑定。

---

## 2. 项目基调与价值主张

- **核心价值**：
  - **找得到**：通过标签、别名、搜索，降低“语言壁垒 + 内容碎片”的障碍。
  - **整理得当**：图单（合集）让收藏更有序。
  - **氛围轻盈**：不是商业化社区，而是纯粹的爱好者收藏馆。

- **非目标**：
  - 不以大规模原创托管为核心。
  - 不承诺完整版权安全，只在开源学习与小范围爱好者使用内循环。

---

## 3. 功能设计

### 3.1 必须功能（MVP）

- **标签系统**：支持多语言别名（中/日/罗马音），模糊检索。
- **作品卡片**：标题、作者、来源链接、标签预览。
- **搜索页**：全局搜索 + 标签过滤，结果栅格化展示。
- **合集（图单）**：用户可新建合集，收录/排序插画，支持关注与评论。
- **作品详情**：大图预览（外链或托管）、元数据、评论、收藏/点赞。
- **用户体系**：最小化（注册/登录，GitHub OAuth + 邮件魔法链）。

### 3.2 后续增强

- **作者档案页**：聚合作者作品（即便仅外链）。
- **相似标签图谱**：自动生成标签共现网络。
- **透明度与治理**：举报、审核日志。
- **个性化推荐**：基于标签与收藏行为。

---

## 4. 技术栈

### 4.1 前端

- **框架**：Next.js (App Router, React Server Components)
- **UI**：HeroUI 全面采用，Tailwind 作为设计系统基础
- **表单**：React Hook Form + Zod
- **命令面板**：kbar（`Cmd/Ctrl + K` 全局搜索）

### 4.2 后端 & 数据

- **数据库**：PostgreSQL
- **ORM**：Prisma ORM
- **校验**：Zod schema 复用
- **搜索**：Postgres `pg_trgm` 扩展模糊检索（MVP），未来可升级 Meilisearch

### 4.3 认证 & 授权

- **Auth.js v5**：GitHub OAuth + Email Magic Link
- **会话**：JWT（轻量）或 PG 存储（稳健）
- **角色**：USER / MOD / ADMIN

### 4.4 存储与图片处理

- **存储**：Cloudflare R2（图片托管，免费层优先）
- **图片处理**：sharp（多规格缩略图、Exif 清理）
- **展示策略**：MVP 阶段可仅做缩略图 + 原站跳转

### 4.5 任务与缓存

- **队列/定时**：Vercel Cron + Inngest / Upstash QStash
- **缓存**：Upstash Redis（热榜、速率限制）

### 4.6 部署与观测

- **部署**：Vercel（应用层），Cloudflare DNS + R2（存储层）
- **监控**：Sentry（错误监控）、PostHog（行为分析）、Vercel Analytics（性能）

---

## 5. 信息架构

- `/discover`：发现页（趋势标签、新合集、精选）
- `/search`：搜索与过滤
- `/tags/[slug]`：标签页（别名、相关标签、作品）
- `/artworks/[id]`：作品详情
- `/collections/[id]`：合集详情
- `/artists/[slug]`：画师档案页
- `/me`：个人中心

---

## 6. 产品体验原则

- **简洁优先**：首页就是搜索框 + 栅格结果。
- **收藏感**：合集/标签不堆砌，像书单而非相册。
- **轻动效**：操作反馈短而快，避免喧宾夺主。
- **来源透明**：每张图都标明原站链接，避免用户误解。
- **低成本运营**：先支持私有收藏与小圈子共享，渐进式演进。

---

## 7. 阶段规划

- **Phase 0**：本地单用户收藏器（爬虫 + 数据库存储 + 搜索 UI）
- **Phase 1**：上线开源 Demo，外链 + 缩略图模式，小规模用户可用
- **Phase 2**：开放合集、评论、关注，逐步社交化
- **Phase 3**：作者档案、相似标签图谱、治理机制完善

---

## 8. 开源策略

- **代码托管**：GitHub（MIT / AGPL 待定）
- **CI/CD**：GitHub Actions + Vercel Preview
- **社区贡献点**：标签别名库、UI 优化、搜索算法调优
- **定位**：学习性 / 爱好者项目，不承诺大规模商业合规

---

## 9. 风险与约束

- **版权风险**：仅限学习与小规模圈子，外链模式更安全；托管模式需谨慎。
- **合规风险**：国内访问与内容审核机制未来需评估。
- **成本约束**：免费层优先，避免大流量带宽消耗。
- **个人精力**：作为兴趣项目，功能节奏需可控，不必追求大而全。

---

## 10. 行动方针

1. **先做可用的搜索与标签系统**，解决“找得到”的核心痛点。
2. **采用外链 + 缩略图策略**，降低风险与成本。
3. **逐步引入图单与社交功能**，营造收藏氛围。
4. **开源透明**，吸引社区参与，积累长期可持续价值。
5. **保持克制**，只做自己真正想用的功能。

---
